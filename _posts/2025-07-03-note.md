---
title: Memo
tag:
    - memo
---

## 도커 입문 2강 - 도커, 도커컴포즈, 도커허브

* [Youtube](https://youtu.be/YmcgYejtGAg?si=yrPFvQPqIWsKktom)

* 도커 : 프로그램이 들어갈 컨테이너를 만들어줌
컨테이너 : OS와 근사한 기능을 제공

* docker-compose : 2개 이상의 컨테이너간 결합 실행을 지원

* docker-hub : github와 유사. 컨테이너를 업로드하는 클라우드 공간

## 도커 입문 3강 - 도커, 도커 허브 설치 및 도커허브 회원가입

* [Youtube](https://youtu.be/mb4Xln-v8xc?si=2IHOe22B6SYMmfil)

* [Docker Desktop for Window 설치](https://www.docker.com/products/docker-desktop/)

주의사항 : 윈도우 10 이상 pro 버전만 설치 가능

1. ![image not found!](https://github.com/Katsudon8991/katsudon8991.github.io/blob/main/img/note/docker-install.PNG?raw=true)

2. ![image not found!](https://github.com/Katsudon8991/katsudon8991.github.io/blob/main/img/note/docker-install1.PNG?raw=true)

3. 제어판, 프로그램(프로그램 보기), Window 기능 켜기/끄기, Hyper-V 체크 해제, Linux용 Window 하위 시스템 체크

4. Window+R 키 입력, cmd 입력, cmd 창에 커서 올리고 

```bash
docker run -d -p 80:80 docker/getting-started
```

입력

5. ![image not found!](https://github.com/Katsudon8991/katsudon8991.github.io/blob/main/img/note/docker-install2.PNG?raw=true)생성된 컨테이너가 작동중(■)인지 확인

6. chrome 주소창에 localhost 입력

7. ![image not found!](https://github.com/Katsudon8991/katsudon8991.github.io/blob/main/img/note/docker-install3.PNG?raw=true)

* [Docker Compose for Windows 설치](https://docs.docker.com/compose/install/standalone/)

1. PowerShell 관리자 권한으로 실행

2. 커서 올리고 아래 명령어 입력

```powershell
Start-BitsTransfer -Source "https://github.com/docker/compose/releases/download/v2.38.1/docker-compose-windows-x86_64.exe" -Destination $Env:ProgramFiles\Docker\docker-compose.exe
```

3. 설치 후, 아래 명령어 입력하여 정상적으로 설치되었는 지 확인

```bash
docker compose version
```

* [Docker Hub 가입](https://hub.docker.com/)

## 도커 입문 7강 - 컨테이너 포트포워딩 및 데몬으로 실행

* 명령어
```bash
docker run -d -p host-port-number:container-port-number image-name
# -d : 백그라운드에서 실행
# -p : 포트포워딩 옵션
# host-port-number : host os에서 요청한 포트 번호
# container-port-number : 컨테이너에 접근 가능한 포트 넘버
# host-port-number로 접근을 요청하면 container-port-number로 컨테이너에 요청함
```

* 입력 예시
```bash
docker run -d -p 8080:80 nginx
# nginx 이미지 컨테이너에 8080포트로 접근을 요청하면 컨테이너에 80포트로 접근을 요청함. 컨테이너의 기본 웹페이지로 접근
```

## 도커 입문 8강 - 모든 image 한 번에 삭제하는 명령어

```bash
docker stop $(docker ps -q)
# 현재 실행중인 도커 컨테이너를 중지
docker rm $(docker ps -a -q)
# 모든 도커 컨테이너 삭제
docker rmi -f $(docker images -q)
# 모든 도커 이미지 삭제
```
* ```$(command)``` 괄호 안의 명령어의 결과값을 현재 명령어의 파라미터로 올린다.

## 도커 입문 9강 - docker dit 옵션과 attach

```bash
docker run -dit --name container-name image-name bash
# -i: interaction.
# -t: terminal.
# -dit: 터미널 모드로 상호작용
```

```bash
docker attach container-id
# 컨테이너의 bash로 연결
```

## 도커 입문 10강 - docker exec 명령어 변경

* 데몬이 돌아가는 컨테이너에 attach 하면 컨테이너가 죽어버린다.

```bash
docker exec -it container-id bash
```
* attach 대신 exec 명령어를 사용해서 컨테이너 os에 접근 가능

* 예시

```bash
# 1. OS(ubuntu)만 설치된 컨테이너를 실행 후, bash로 접근하고 싶으면
docker run -dit ubuntu bash
#   or
docker attach container-id
# 2. while process (httpd) 컨테이너를 실행 후, 컨테이너 os에 접근하고 싶다면
docker run -d -p 8080:80 httpd
docker exec -it container-id bash
```

## 도커 입문 11강 - docker volume옵션으로 폴더 연결하기

* -v 옵션 : 호스트OS와 컨테이너 사이에 파일 시스템을 공유하는 옵션

```bash
docker run -v host-directory-path:container-directory-path
```

* 예시

```bash
docker run -d -p 8080:80 -v host-directory-path:/usr/local/apache2/htdocs httpd
```

## 도커 입문 13강 - Dockerfile step1 - 기본기

* Dockerfile 작성방법
```txt
FROM httpd
COPY ./webapp /usr/local/apache2/htdocs
CMD ["httpd-foreground"]
```
* ```FROM``` : docker hub에서 가져올 이미지 이름
* ```COPY``` : volume 설정
* ```CMD``` : image 실행 시 처음 실행되는 명령어

## 도커 입문 14강 - Dockerfile step2 - Entrypoint와 Workdir

```txt
FROM openjdk:11-jdk-slim

WORKDIR /app
# host os에서 container bash 접근 경로

# ADD 압축파일.zip ./ #이렇게 하면 압축이 풀린다.

COPY build/aws-v3-0.0.3.jar ./application.jar

ENTRYPOINT ["java", "-jar", "-Dspring.profiles.active=dev","application.jar"]
# 무조건 실행할 실행 명령어

CMD ["--server.port=8080"]
# 그 뒤에 붙는 옵션. container 실행 시 대체될 수 있음
```

## 도커 입문 15강 - Dockerfile step3 - RUN 명령어

```txt
FROM ubuntu

RUN apt-get update
RUN apt-get install -y nginx
# 도커 이미지를 빌드하는 순간에 실행되는 명령어

WORKDIR /var/www/html

COPY ./webapp/index.html ./index.nginx-debian.html

ENTRYPOINT [ "nginx", "-g", "daemon off;" ]
# 이미지로부터 컨테이너를 생성하여 최초로 실행할 때 수행.

#CMD 이미지로부터 컨테이너를 생성하여 최초로 실행할 때 수행. docker run 할 때 변경가능
```
<!-- 
## 도커 입문 16강 - Dockerfile step4 - nginx 내부구성 알아보기 -->